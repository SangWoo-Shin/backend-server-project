# ğŸ¯ ì´ë²¤íŠ¸ / ë³´ìƒ ê´€ë¦¬ í”Œë«í¼ - ë°±ì—”ë“œ ê³¼ì œ

## ğŸ“Œ í”„ë¡œì íŠ¸ ê°œìš”
NestJS, MongoDB, JWT, Dockerë¥¼ í™œìš©í•œ ì´ë²¤íŠ¸/ë³´ìƒ ê´€ë¦¬ ì‹œìŠ¤í…œì…ë‹ˆë‹¤. ì¸ì¦ ë° ì—­í•  ê¸°ë°˜ ê¶Œí•œ ì œì–´ë¥¼ í¬í•¨í•œ MSA ì•„í‚¤í…ì²˜ êµ¬ì¡°ë¡œ êµ¬ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.

---

## ğŸ§± ê¸°ìˆ  ìŠ¤íƒ

| í•­ëª©         | ì‚¬ìš© ê¸°ìˆ                |
|--------------|------------------------|
| Language     | TypeScript             |
| Framework    | NestJS                 |
| Database     | MongoDB (Mongoose)     |
| Auth         | JWT, Passport, Guards  |
| Docs         | Swagger (OpenAPI)      |
| Container    | Docker, docker-compose |

---

## âš™ï¸ ì„œë²„ êµ¬ì¡° (MSA ê¸°ë°˜)

| ì„œë²„ ì´ë¦„        | ì—­í•  ì„¤ëª…                                     |
|------------------|----------------------------------------------|
| Gateway Server   | ëª¨ë“  API ìš”ì²­ ì§„ì…ì , ì¸ì¦/ê¶Œí•œ ê²€ì‚¬ ë° ë¼ìš°íŒ… |
| Auth Server      | íšŒì›ê°€ì…, ë¡œê·¸ì¸, JWT ë°œê¸‰, ìœ ì € ê¶Œí•œ ê´€ë¦¬     |
| Event Server     | ì´ë²¤íŠ¸, ë³´ìƒ, ë³´ìƒ ìš”ì²­ CRUD ë° ìƒíƒœ ê´€ë¦¬       |

---

## âœ… êµ¬í˜„ ê¸°ëŠ¥ ìš”ì•½

### ğŸ§‘â€ğŸ’» Auth ê¸°ëŠ¥
- íšŒì›ê°€ì… (USERë¡œ ê¸°ë³¸ ë“±ë¡)
- ë¡œê·¸ì¸ (JWT ë°œê¸‰)
- ìœ ì € ì •ë³´ ì¡°íšŒ (ë³¸ì¸ or ê´€ë¦¬ì)
- ìœ ì € ê¶Œí•œ ë³€ê²½ (ADMIN ì „ìš©)

### ğŸ‰ Event ê¸°ëŠ¥
- ì´ë²¤íŠ¸ ìƒì„± (ADMIN, OPERATOR)
- ì „ì²´ / ë‹¨ì¼ ì´ë²¤íŠ¸ ì¡°íšŒ (ADMIN, OPERATOR, AUDITOR)
- ì´ë²¤íŠ¸ ë¹„í™œì„±í™” (ADMIN, OPERATOR)

### ğŸ† Reward ê¸°ëŠ¥
- ë³´ìƒ ìƒì„± (ADMIN, OPERATOR)
- ì „ì²´ ë³´ìƒ ëª©ë¡ / ì´ë²¤íŠ¸ë³„ ë³´ìƒ ì¡°íšŒ
- ë³´ìƒ ë‹¨ì¼ ì¡°íšŒ

### ğŸ Reward Request ê¸°ëŠ¥
- ë³´ìƒ ìš”ì²­ (USER)
- ë³¸ì¸ ìš”ì²­ ë‚´ì—­ ì¡°íšŒ (USER)
- ì „ì²´ ìš”ì²­ ë‚´ì—­ ì¡°íšŒ (ADMIN, OPERATOR, AUDITOR)
- ìš”ì²­ ìƒíƒœ ë³€ê²½ (ADMIN, OPERATOR)

---

## ğŸ›¡ï¸ ì¸ì¦ ë° ê¶Œí•œ ì‹œìŠ¤í…œ

- JWT ê¸°ë°˜ ì¸ì¦ (Passport ì‚¬ìš©)
- `@UseGuards(JwtAuthGuard, RolesGuard)`
- `@Roles('ADMIN')` ë“±ìœ¼ë¡œ ì—­í•  ì œí•œ
- Gatewayì—ì„œ ì¸ì¦ â†’ ê° ì„œë¹„ìŠ¤ë¡œ í† í° ì „ë‹¬

---

## ğŸ“¦ ì‹¤í–‰ ë°©ë²• (Docker ê¸°ë°˜)

1. ê° ì„œë¹„ìŠ¤ ë””ë ‰í† ë¦¬ì— `.env` íŒŒì¼ì„ ì„¤ì •í•©ë‹ˆë‹¤.
    #### ğŸ“ auth_server/.env
    ```env
    MONGODB_URI=mongodb://mongo:27017/mydb
    ```
    #### ğŸ“ event_server/.env
    ```env
    AUTH_SERVER_URL=http://auth-server:3001
    MONGODB_URI=mongodb://mongo:27017/mydb
    ```
    #### ğŸ“ gateway_server/.env.docker
    ```env.docker
    AUTH_BASE_URL=http://auth-server:3001
    EVENT_BASE_URL=http://event-server:3000
    ```
    
2. Docker ì‹¤í–‰
    ```bash
    docker-compose up --build
    ```
    
---

## ğŸ§ª ì´ˆê¸° ë”ë¯¸ ë°ì´í„° (ìƒ˜í”Œ ê³„ì • ë° ë¦¬ì†ŒìŠ¤)

### ğŸ‘¤ ìœ ì € ëª©ë¡

| ì´ë©”ì¼                 | ë¹„ë°€ë²ˆí˜¸             | ì—­í•          |
|----------------------|--------------------|-------------|
| admin@nexon.com      | Admin123!          | ADMIN       |
| user@nexon.com       | User123!           | USER        |
| auditor@nexon.com    | Auditor123!        | AUDITOR     |
| operator@nexon.com   | Operator123!       | OPERATOR    |

### ğŸ“… ì´ë²¤íŠ¸ ëª©ë¡

| ì œëª©                  | ì¡°ê±´ í‚¤              | ê¸°ê°„                     | ìƒíƒœ   |
|----------------------|--------------------|-------------------------|-------|
| 7ì¼ ì—°ì† ë¡œê·¸ì¸          | login_7_days       | 2025-05-01 ~ 2025-06-01 | í™œì„±í™”  | 
| ë²„ë‹ íƒ€ì„! ê²½í—˜ì¹˜ 2ë°°     | exp_double_event   | 2025-06-10 ~ 2025-06-30 | í™œì„±í™”  | 
| ì¶”ì„ë§ì´ í•œì •íŒ ìŠ¤í‚¨ ì§€ê¸‰   | login_once_chuseok | 2025-09-05 ~ 2025-09-15 | ë¹„í™œì„±í™” | 

### ğŸ ë³´ìƒ ëª©ë¡

| ì´ë¦„                  | íƒ€ì…        | ìˆ˜ëŸ‰  | ì—°ë™ ì´ë²¤íŠ¸(ID)                           |
|----------------------|------------|------|----------------------------------------|
| 7ì¼ ì¶œì„ ê¸°ë… ì„ ë¬¼ ìƒì   | ì•„ì´í…œ ìƒì   | 1    | 682abbddee9c6e2597fd0342 (7ì¼ ì—°ì† ë¡œê·¸ì¸) |
| ë²„ë‹ ë¶€ìŠ¤í„° í¬ì…˜         | ë²„í”„ ì•„ì´í…œ   | 3    | 682abc7dee9c6e2597fd0344 (ë²„ë‹ íƒ€ì„)      |
| í•œì •íŒ ì½”ìŠ¤íŠ¬ ë½‘ê¸°ê¶Œ      | ë½‘ê¸° ì¿ í°     | 1    | 682abc8bee9c6e2597fd0346 (ì¶”ì„ë§ì´)       |

---

## ğŸ“– Swagger ë¬¸ì„œ í™•ì¸

| ì„œë¹„ìŠ¤         | í¬íŠ¸          | Swagger ì£¼ì†Œ                    |
|--------------|--------------|--------------------------------|
| Gateway      | 3002         | http://localhost:3002/api-docs |
| Auth         | 3001         | http://localhost:3001/api-docs |
| Event        | 3000         | http://localhost:3000/api-docs |

## ğŸ“˜ Swagger ë¬¸ì„œ ë¯¸ë¦¬ë³´ê¸°

#### ğŸ” Auth ì„œë²„
![auth-swagger](./assets/Swagger-auth.png)

#### ğŸ‰ Event ì„œë²„
![event-swagger](./assets/Swagger-event.png)

#### ğŸŒ Gateway ì„œë²„
![gateway-swagger](./assets/Swagger-gateway.png)

---


## ğŸ“ í´ë” êµ¬ì¡° ì˜ˆì‹œ

```bash
â”œâ”€â”€ gateway_server
â”‚   â””â”€â”€ src
â”‚       â”œâ”€â”€ auth
â”‚       â”œâ”€â”€ proxy
â”‚       â”œâ”€â”€ dto
â”‚       â”œâ”€â”€ Dockerfile
â”‚       â””â”€â”€ main.ts
â”œâ”€â”€ auth_server
â”‚   â””â”€â”€ src
â”‚       â”œâ”€â”€ auth
â”‚       â”œâ”€â”€ user
â”‚       â”œâ”€â”€ Dockerfile
â”‚       â””â”€â”€ main.ts
â”œâ”€â”€ event_server
â”‚   â””â”€â”€ src
â”‚       â”œâ”€â”€ auth
â”‚       â”œâ”€â”€ reward
â”‚       â”œâ”€â”€ reward-request
â”‚       â”œâ”€â”€ event
â”‚       â”œâ”€â”€ Dockerfile
â”‚       â””â”€â”€ main.ts
â”œâ”€â”€  Docker-compose.yml
```

---

## ğŸ“Œ ì°¸ê³  ì‚¬í•­
- ì¡°ê±´ ê²€ì¦ ë¡œì§ì€ ê°„ë‹¨í•œ ì˜ˆì‹œ ìˆ˜ì¤€ì…ë‹ˆë‹¤ (ex: ë¡œê·¸ì¸ 1ì‹œê°„ ì´ìƒ)
- ì‚­ì œ APIëŠ” êµ¬í˜„í•˜ì§€ ì•Šê³  `isActive`ë¥¼ í†µí•œ ë¹„í™œì„±í™” ì²˜ë¦¬
- ê° ì„œë¹„ìŠ¤ëŠ” ë…ë¦½ëœ Swagger ë¬¸ì„œë¥¼ í†µí•´ í™•ì¸ ê°€ëŠ¥
